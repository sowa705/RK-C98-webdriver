(function(){"use strict";const l=new Array,s=new Date,o=new Date,T=3e3;let g=null,a=!1,i=!1,f="";self.addEventListener("message",e=>{if(e.data==="start")console.log("Communication start loop...."),r();else if(e.data==="stop")g!=null&&clearInterval(g);else if(e.data==="finish")a=!1,i=!1,l.length<=0&&self.postMessage("finish");else if(e.data==="report"){const t=new Date;s.setTime(t.getTime()),o.setTime(t.getTime()),i=!1}else{let t=e.data;const n=new Date;o.setTime(n.getTime()),l.splice(0,0,t)}});function r(){g=setInterval(()=>{const e=new Date;let t=e.getTime()-s.getTime(),n=e.getTime()-o.getTime();if(t>T&&a&&(s.setTime(e.getTime()),self.postMessage("timeout")),a)i||n>15&&(self.postMessage(f),s.setTime(e.getTime()),i=!0);else if(l.length>0&&n>15){let m=l.pop();m!=null&&(f=m,self.postMessage(m),s.setTime(e.getTime()),a=!0,i=!0)}},10)}})();
